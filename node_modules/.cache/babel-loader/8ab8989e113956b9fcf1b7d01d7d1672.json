{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n    m = s && o[s],\n    i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BaseTransaction = void 0;\nvar common_1 = __importStar(require(\"@ethereumjs/common\"));\nvar ethereumjs_util_1 = require(\"ethereumjs-util\");\nvar types_1 = require(\"./types\");\n/**\n * This base class will likely be subject to further\n * refactoring along the introduction of additional tx types\n * on the Ethereum network.\n *\n * It is therefore not recommended to use directly.\n */\nvar BaseTransaction = /** @class */function () {\n  function BaseTransaction(txData) {\n    this.cache = {\n      hash: undefined\n    };\n    /**\n     * List of tx type defining EIPs,\n     * e.g. 1559 (fee market) and 2930 (access lists)\n     * for FeeMarketEIP1559Transaction objects\n     */\n    this.activeCapabilities = [];\n    /**\n     * The default chain the tx falls back to if no Common\n     * is provided and if the chain can't be derived from\n     * a passed in chainId (only EIP-2718 typed txs) or\n     * EIP-155 signature (legacy txs).\n     *\n     * @hidden\n     */\n    this.DEFAULT_CHAIN = common_1.Chain.Mainnet;\n    /**\n     * The default HF if the tx type is active on that HF\n     * or the first greater HF where the tx is active.\n     *\n     * @hidden\n     */\n    this.DEFAULT_HARDFORK = common_1.Hardfork.Istanbul;\n    var nonce = txData.nonce,\n      gasLimit = txData.gasLimit,\n      to = txData.to,\n      value = txData.value,\n      data = txData.data,\n      v = txData.v,\n      r = txData.r,\n      s = txData.s,\n      type = txData.type;\n    this._type = new ethereumjs_util_1.BN((0, ethereumjs_util_1.toBuffer)(type)).toNumber();\n    var toB = (0, ethereumjs_util_1.toBuffer)(to === '' ? '0x' : to);\n    var vB = (0, ethereumjs_util_1.toBuffer)(v === '' ? '0x' : v);\n    var rB = (0, ethereumjs_util_1.toBuffer)(r === '' ? '0x' : r);\n    var sB = (0, ethereumjs_util_1.toBuffer)(s === '' ? '0x' : s);\n    this.nonce = new ethereumjs_util_1.BN((0, ethereumjs_util_1.toBuffer)(nonce === '' ? '0x' : nonce));\n    this.gasLimit = new ethereumjs_util_1.BN((0, ethereumjs_util_1.toBuffer)(gasLimit === '' ? '0x' : gasLimit));\n    this.to = toB.length > 0 ? new ethereumjs_util_1.Address(toB) : undefined;\n    this.value = new ethereumjs_util_1.BN((0, ethereumjs_util_1.toBuffer)(value === '' ? '0x' : value));\n    this.data = (0, ethereumjs_util_1.toBuffer)(data === '' ? '0x' : data);\n    this.v = vB.length > 0 ? new ethereumjs_util_1.BN(vB) : undefined;\n    this.r = rB.length > 0 ? new ethereumjs_util_1.BN(rB) : undefined;\n    this.s = sB.length > 0 ? new ethereumjs_util_1.BN(sB) : undefined;\n    this._validateCannotExceedMaxInteger({\n      nonce: this.nonce,\n      gasLimit: this.gasLimit,\n      value: this.value,\n      r: this.r,\n      s: this.s\n    });\n  }\n  Object.defineProperty(BaseTransaction.prototype, \"transactionType\", {\n    /**\n     * Alias for {@link BaseTransaction.type}\n     *\n     * @deprecated Use `type` instead\n     */\n    get: function () {\n      return this.type;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(BaseTransaction.prototype, \"type\", {\n    /**\n     * Returns the transaction type.\n     *\n     * Note: legacy txs will return tx type `0`.\n     */\n    get: function () {\n      return this._type;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\n   * Checks if a tx type defining capability is active\n   * on a tx, for example the EIP-1559 fee market mechanism\n   * or the EIP-2930 access list feature.\n   *\n   * Note that this is different from the tx type itself,\n   * so EIP-2930 access lists can very well be active\n   * on an EIP-1559 tx for example.\n   *\n   * This method can be useful for feature checks if the\n   * tx type is unknown (e.g. when instantiated with\n   * the tx factory).\n   *\n   * See `Capabilites` in the `types` module for a reference\n   * on all supported capabilities.\n   */\n  BaseTransaction.prototype.supports = function (capability) {\n    return this.activeCapabilities.includes(capability);\n  };\n  BaseTransaction.prototype.validate = function (stringError) {\n    if (stringError === void 0) {\n      stringError = false;\n    }\n    var errors = [];\n    if (this.getBaseFee().gt(this.gasLimit)) {\n      errors.push(\"gasLimit is too low. given \" + this.gasLimit + \", need at least \" + this.getBaseFee());\n    }\n    if (this.isSigned() && !this.verifySignature()) {\n      errors.push('Invalid Signature');\n    }\n    return stringError ? errors : errors.length === 0;\n  };\n  /**\n   * The minimum amount of gas the tx must have (DataFee + TxFee + Creation Fee)\n   */\n  BaseTransaction.prototype.getBaseFee = function () {\n    var fee = this.getDataFee().addn(this.common.param('gasPrices', 'tx'));\n    if (this.common.gteHardfork('homestead') && this.toCreationAddress()) {\n      fee.iaddn(this.common.param('gasPrices', 'txCreation'));\n    }\n    return fee;\n  };\n  /**\n   * The amount of gas paid for the data in this tx\n   */\n  BaseTransaction.prototype.getDataFee = function () {\n    var txDataZero = this.common.param('gasPrices', 'txDataZero');\n    var txDataNonZero = this.common.param('gasPrices', 'txDataNonZero');\n    var cost = 0;\n    for (var i = 0; i < this.data.length; i++) {\n      this.data[i] === 0 ? cost += txDataZero : cost += txDataNonZero;\n    }\n    return new ethereumjs_util_1.BN(cost);\n  };\n  /**\n   * If the tx's `to` is to the creation address\n   */\n  BaseTransaction.prototype.toCreationAddress = function () {\n    return this.to === undefined || this.to.buf.length === 0;\n  };\n  BaseTransaction.prototype.isSigned = function () {\n    var _a = this,\n      v = _a.v,\n      r = _a.r,\n      s = _a.s;\n    if (this.type === 0) {\n      if (!v || !r || !s) {\n        return false;\n      } else {\n        return true;\n      }\n    } else {\n      if (v === undefined || !r || !s) {\n        return false;\n      } else {\n        return true;\n      }\n    }\n  };\n  /**\n   * Determines if the signature is valid\n   */\n  BaseTransaction.prototype.verifySignature = function () {\n    try {\n      // Main signature verification is done in `getSenderPublicKey()`\n      var publicKey = this.getSenderPublicKey();\n      return (0, ethereumjs_util_1.unpadBuffer)(publicKey).length !== 0;\n    } catch (e) {\n      return false;\n    }\n  };\n  /**\n   * Returns the sender's address\n   */\n  BaseTransaction.prototype.getSenderAddress = function () {\n    return new ethereumjs_util_1.Address((0, ethereumjs_util_1.publicToAddress)(this.getSenderPublicKey()));\n  };\n  /**\n   * Signs a transaction.\n   *\n   * Note that the signed tx is returned as a new object,\n   * use as follows:\n   * ```javascript\n   * const signedTx = tx.sign(privateKey)\n   * ```\n   */\n  BaseTransaction.prototype.sign = function (privateKey) {\n    if (privateKey.length !== 32) {\n      throw new Error('Private key must be 32 bytes in length.');\n    }\n    // Hack for the constellation that we have got a legacy tx after spuriousDragon with a non-EIP155 conforming signature\n    // and want to recreate a signature (where EIP155 should be applied)\n    // Leaving this hack lets the legacy.spec.ts -> sign(), verifySignature() test fail\n    // 2021-06-23\n    var hackApplied = false;\n    if (this.type === 0 && this.common.gteHardfork('spuriousDragon') && !this.supports(types_1.Capability.EIP155ReplayProtection)) {\n      this.activeCapabilities.push(types_1.Capability.EIP155ReplayProtection);\n      hackApplied = true;\n    }\n    var msgHash = this.getMessageToSign(true);\n    var _a = (0, ethereumjs_util_1.ecsign)(msgHash, privateKey),\n      v = _a.v,\n      r = _a.r,\n      s = _a.s;\n    var tx = this._processSignature(v, r, s);\n    // Hack part 2\n    if (hackApplied) {\n      var index = this.activeCapabilities.indexOf(types_1.Capability.EIP155ReplayProtection);\n      if (index > -1) {\n        this.activeCapabilities.splice(index, 1);\n      }\n    }\n    return tx;\n  };\n  /**\n   * Does chain ID checks on common and returns a common\n   * to be used on instantiation\n   * @hidden\n   *\n   * @param common - {@link Common} instance from tx options\n   * @param chainId - Chain ID from tx options (typed txs) or signature (legacy tx)\n   */\n  BaseTransaction.prototype._getCommon = function (common, chainId) {\n    var _a;\n    // Chain ID provided\n    if (chainId) {\n      var chainIdBN = new ethereumjs_util_1.BN((0, ethereumjs_util_1.toBuffer)(chainId));\n      if (common) {\n        if (!common.chainIdBN().eq(chainIdBN)) {\n          throw new Error('The chain ID does not match the chain ID of Common');\n        }\n        // Common provided, chain ID does match\n        // -> Return provided Common\n        return common.copy();\n      } else {\n        if (common_1.default.isSupportedChainId(chainIdBN)) {\n          // No Common, chain ID supported by Common\n          // -> Instantiate Common with chain ID\n          return new common_1.default({\n            chain: chainIdBN,\n            hardfork: this.DEFAULT_HARDFORK\n          });\n        } else {\n          // No Common, chain ID not supported by Common\n          // -> Instantiate custom Common derived from DEFAULT_CHAIN\n          return common_1.default.forCustomChain(this.DEFAULT_CHAIN, {\n            name: 'custom-chain',\n            networkId: chainIdBN,\n            chainId: chainIdBN\n          }, this.DEFAULT_HARDFORK);\n        }\n      }\n    } else {\n      // No chain ID provided\n      // -> return Common provided or create new default Common\n      return (_a = common === null || common === void 0 ? void 0 : common.copy()) !== null && _a !== void 0 ? _a : new common_1.default({\n        chain: this.DEFAULT_CHAIN,\n        hardfork: this.DEFAULT_HARDFORK\n      });\n    }\n  };\n  BaseTransaction.prototype._validateCannotExceedMaxInteger = function (values, bits) {\n    var e_1, _a;\n    if (bits === void 0) {\n      bits = 53;\n    }\n    try {\n      for (var _b = __values(Object.entries(values)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var _d = __read(_c.value, 2),\n          key = _d[0],\n          value = _d[1];\n        if (bits === 53) {\n          if (value === null || value === void 0 ? void 0 : value.gt(ethereumjs_util_1.MAX_INTEGER)) {\n            throw new Error(key + \" cannot exceed MAX_INTEGER, given \" + value);\n          }\n        } else if (bits === 256) {\n          if (value === null || value === void 0 ? void 0 : value.gte(ethereumjs_util_1.TWO_POW256)) {\n            throw new Error(key + \" must be less than 2^256, given \" + value);\n          }\n        } else {\n          throw new Error('unimplemented bits value');\n        }\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  };\n  return BaseTransaction;\n}();\nexports.BaseTransaction = BaseTransaction;","map":{"version":3,"names":["common_1","__importStar","require","ethereumjs_util_1","types_1","BaseTransaction","txData","cache","hash","undefined","activeCapabilities","DEFAULT_CHAIN","Chain","Mainnet","DEFAULT_HARDFORK","Hardfork","Istanbul","nonce","gasLimit","to","value","data","v","r","s","type","_type","BN","toBuffer","toNumber","toB","vB","rB","sB","length","Address","_validateCannotExceedMaxInteger","Object","defineProperty","prototype","get","supports","capability","includes","validate","stringError","errors","getBaseFee","gt","push","isSigned","verifySignature","fee","getDataFee","addn","common","param","gteHardfork","toCreationAddress","iaddn","txDataZero","txDataNonZero","cost","i","buf","_a","publicKey","getSenderPublicKey","unpadBuffer","e","getSenderAddress","publicToAddress","sign","privateKey","Error","hackApplied","Capability","EIP155ReplayProtection","msgHash","getMessageToSign","ecsign","tx","_processSignature","index","indexOf","splice","_getCommon","chainId","chainIdBN","eq","copy","default","isSupportedChainId","chain","hardfork","forCustomChain","name","networkId","values","bits","_b","__values","entries","_c","next","done","_d","__read","key","MAX_INTEGER","gte","TWO_POW256","exports"],"sources":["../src/baseTransaction.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script"}